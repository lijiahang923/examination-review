# Datebase class

数据库

根据您提供的PPT课件内容，我为您整理了一份详细的\*\*《数据库系统与应用》考试复习资料\*\*。这份资料涵盖了从基础理论到SQL Server操作，再到程序开发的各个重点。



---



\# 数据库系统与应用（SQL Server 2008 + ADO.NET）复习大纲



\## 第一部分：数据库基础理论 (第1-3章)



\### 1. 基本概念

\*   \*\*数据 (Data) 与 信息 (Information)\*\*：数据是信息的载体，信息是数据的内涵（经过加工有用的知识）。

\*   \*\*数据库 (DB)\*\*：长期存储、有组织、可共享的数据集合。

\*   \*\*数据库管理系统 (DBMS)\*\*：位于用户/应用与操作系统之间的系统软件，负责数据管理（定义、操纵、控制）。

\*   \*\*数据库系统 (DBS)\*\*：由数据库、硬件、软件（DBMS+OS）、人员（DBA、开发人员、用户）组成。



\### 2. 数据管理技术的发展

\*   \*\*三个阶段\*\*：人工管理 $\\rightarrow$ 文件系统 $\\rightarrow$ 数据库系统。

\*   \*\*数据库系统的特点\*\*：数据结构化、数据共享性高、冗余度低、数据独立性高（逻辑/物理独立性）。



\### 3. 数据库体系结构 (三级模式 \& 两级映像)

\*   \*\*三级模式\*\*：

&nbsp;   \*   \*\*外模式 (用户模式)\*\*：用户看到的局部数据视图。

&nbsp;   \*   \*\*模式 (逻辑/概念模式)\*\*：全体数据的逻辑结构，一个数据库只有一个。

&nbsp;   \*   \*\*内模式 (存储/物理模式)\*\*：数据在物理存储介质上的存放方式。

\*   \*\*两级映像\*\*：

&nbsp;   \*   \*\*外模式/模式映像\*\* $\\rightarrow$ 保证\*\*逻辑独立性\*\* (逻辑结构改变，程序不用改)。

&nbsp;   \*   \*\*模式/内模式映像\*\* $\\rightarrow$ 保证\*\*物理独立性\*\* (存储结构改变，逻辑结构不用改)。



\### 4. 数据模型

\*   \*\*概念模型\*\*：按用户观点建模，常用 \*\*E-R图 (实体-联系图)\*\*。

&nbsp;   \*   \*\*要素\*\*：实体 (矩形)、属性 (椭圆)、联系 (菱形)。

&nbsp;   \*   \*\*联系类型\*\*：1:1 (一对一)、1:n (一对多)、m:n (多对多)。

\*   \*\*逻辑/数据模型\*\*：

&nbsp;   \*   \*\*层次模型\*\* (树状结构)、\*\*网状模型\*\* (图状结构)。

&nbsp;   \*   \*\*关系模型\*\* (二维表结构，最常用)。

&nbsp;   \*   \*\*面向对象模型\*\*。



\### 5. 关系模型理论 (重点)

\*   \*\*基本术语\*\*：关系(表)、元组(行)、属性(列)、域(取值范围)。

\*   \*\*键 (Key)\*\*：

&nbsp;   \*   \*\*候选键\*\*：能唯一标识元组的属性组。

&nbsp;   \*   \*\*主键 (Primary Key)\*\*：被选中的候选键，唯一且非空。

&nbsp;   \*   \*\*外键 (Foreign Key)\*\*：引用其他表的主键，用于建立联系。

\*   \*\*完整性约束 (三类)\*\*：

&nbsp;   1.  \*\*实体完整性\*\*：主键不能为空。

&nbsp;   2.  \*\*参照完整性\*\*：外键必须取空值或有效的主键值。

&nbsp;   3.  \*\*用户定义完整性\*\*：针对具体数据的约束 (如年龄>0)。

\*   \*\*关系代数\*\*：

&nbsp;   \*   \*\*传统集合运算\*\*：并($\\cup$)、交($\\cap$)、差($-$)、笛卡尔积($\\times$)。

&nbsp;   \*   \*\*专门关系运算\*\*：选择($\\sigma$，选行)、投影($\\pi$，选列)、连接($\\bowtie$，多表结合)、除($\\div$)。



---



\## 第二部分：数据库设计 (第5章)



\### 1. 设计步骤 (6个阶段)

1\.  \*\*规划\*\*：可行性分析。

2\.  \*\*需求分析\*\*：收集需求，产出数据流图(DFD)、数据字典(DD)。

3\.  \*\*概念结构设计\*\*：\*\*E-R图\*\* (关键步骤，独立于DBMS)。

4\.  \*\*逻辑结构设计\*\*：将E-R图转换为关系模式 (表)，进行规范化。

&nbsp;   \*   \*转换规则\*：1:1 (属性并入任一方)、1:n (1端主键放入n端作外键)、m:n (新建一张表，包含两端主键)。

5\.  \*\*物理结构设计\*\*：索引设计、存储路径选择。

6\.  \*\*实施与维护\*\*：建库、载入数据、试运行。



---



\## 第三部分：SQL Server 管理与操作 (第6-8, 10章)



\### 1. 系统数据库

\*   \*\*master\*\*：记录所有系统级信息 (登录、配置)，最重要。

\*   \*\*model\*\*：创建新数据库的模板。

\*   \*\*msdb\*\*：用于代理服务 (Agent)，调度作业和报警。

\*   \*\*tempdb\*\*：临时工作区，重启后重建。



\### 2. 数据库与表管理 (T-SQL)

\*   \*\*创建数据库\*\*：`CREATE DATABASE` (含 `ON PRIMARY` 数据文件.mdf, `LOG ON` 日志文件.ldf)。

\*   \*\*创建表\*\*：`CREATE TABLE`。

\*   \*\*修改表\*\*：`ALTER TABLE` (ADD, DROP COLUMN, ALTER COLUMN)。

\*   \*\*删除表\*\*：`DROP TABLE`。

\*   \*\*数据类型\*\*：`int`, `char` (定长), `varchar` (变长), `datetime`, `money` 等。



\### 3. 约束与索引

\*   \*\*五大约束\*\*：

&nbsp;   \*   `PRIMARY KEY` (主键)

&nbsp;   \*   `FOREIGN KEY` (外键)

&nbsp;   \*   `UNIQUE` (唯一)

&nbsp;   \*   `CHECK` (检查条件)

&nbsp;   \*   `DEFAULT` (默认值)

&nbsp;   \*   `NOT NULL` (非空)

\*   \*\*索引 (Index)\*\*：

&nbsp;   \*   \*\*聚集索引 (Clustered)\*\*：物理顺序与索引顺序一致，一张表只能有一个 (通常是主键)。

&nbsp;   \*   \*\*非聚集索引 (Non-clustered)\*\*：逻辑有序，物理无序，一张表可有多个。

&nbsp;   \*   语法：`CREATE INDEX` / `DROP INDEX`。



\### 4. 安全管理

\*   \*\*验证模式\*\*：Windows身份验证 (更安全)、混合模式 (SQL账号+Windows账号)。

\*   \*\*层级\*\*：登录名 (服务器级) $\\rightarrow$ 用户 (数据库级) $\\rightarrow$ 权限 (对象级)。

\*   \*\*权限操作\*\*：

&nbsp;   \*   `GRANT` (授权)

&nbsp;   \*   `REVOKE` (收回)

&nbsp;   \*   `DENY` (拒绝)



\### 5. 维护 (备份与恢复)

\*   \*\*恢复模式\*\*：简单、完整、大容量日志。

\*   \*\*备份类型\*\*：完整备份、差异备份、事务日志备份。

\*   \*\*分离与附加\*\*：用于数据库的迁移 (移动 .mdf 和 .ldf 文件)。



---



\## 第四部分：SQL 语言 (第9章 - 核心重点)



\### 1. 数据定义语言 (DDL)

\*   `CREATE`, `ALTER`, `DROP`



\### 2. 数据操纵语言 (DML)

\*   \*\*插入\*\*：`INSERT INTO 表名 (列...) VALUES (值...)`

\*   \*\*更新\*\*：`UPDATE 表名 SET 列=值 WHERE 条件`

\*   \*\*删除\*\*：`DELETE FROM 表名 WHERE 条件`



\### 3. 数据查询语言 (DQL) - SELECT

\*   \*\*基本结构\*\*：

&nbsp;   ```sql

&nbsp;   SELECT \[TOP n] <列名>

&nbsp;   FROM <表名>

&nbsp;   WHERE <条件>

&nbsp;   GROUP BY <分组列> HAVING <分组条件>

&nbsp;   ORDER BY <排序列> \[ASC|DESC]

&nbsp;   ```

\*   \*\*常用查询技巧\*\*：

&nbsp;   \*   \*\*模糊查询\*\*：`LIKE` (通配符 `%`, `\_`)。

&nbsp;   \*   \*\*空值判断\*\*：`IS NULL`, `IS NOT NULL`。

&nbsp;   \*   \*\*范围\*\*：`BETWEEN...AND`, `IN (...)`.

&nbsp;   \*   \*\*聚合函数\*\*：`COUNT()`, `SUM()`, `AVG()`, `MAX()`, `MIN()`。

&nbsp;   \*   \*\*分组\*\*：`GROUP BY` (注意：聚合函数作为条件必须用 `HAVING`，不能用 `WHERE`)。

\*   \*\*多表连接 (JOIN)\*\*：

&nbsp;   \*   \*\*内连接 (INNER JOIN)\*\*：只返回匹配的行。

&nbsp;   \*   \*\*左外连接 (LEFT JOIN)\*\*：返回左表所有行 + 右表匹配行 (无匹配则NULL)。

&nbsp;   \*   \*\*右外连接 (RIGHT JOIN)\*\*：返回右表所有行 + 左表匹配行。

\*   \*\*子查询\*\*：嵌套在 `WHERE` 中，使用 `IN`, `EXISTS`, `ANY`, `ALL` 或比较运算符。



\### 4. 视图 (View)

\*   \*\*定义\*\*：虚表，存储查询定义，不存储数据。

\*   \*\*作用\*\*：简化查询、提高安全性 (屏蔽敏感列)、逻辑独立性。

\*   语法：`CREATE VIEW 视图名 AS SELECT...`



---



\## 第五部分：数据库开发技术 - ADO.NET (第13-14章)



\### 1. ADO.NET 架构

\*   \*\*.NET Data Provider (数据提供程序)\*\*：连接数据库的组件。

&nbsp;   \*   `Connection`：建立连接。

&nbsp;   \*   `Command`：执行SQL命令 (增删改查)。

&nbsp;   \*   `DataReader`：\*\*只读、只进\*\*的数据流 (在线模式)。

&nbsp;   \*   `DataAdapter`：\*\*桥梁\*\*，填充DataSet和更新数据库。

\*   \*\*DataSet (数据集)\*\*：

&nbsp;   \*   \*\*离线模式\*\* (断开式) 的核心。

&nbsp;   \*   内存中的数据库副本，包含 `DataTable`, `DataRow`, `DataColumn`。



\### 2. 核心类与命名空间

\*   命名空间：`System.Data.SqlClient` (针对SQL Server)。

\*   \*\*SqlConnection\*\*：

&nbsp;   \*   属性：`ConnectionString` (包含Data Source, Initial Catalog, User ID, Password)。

&nbsp;   \*   方法：`Open()`, `Close()`。

\*   \*\*SqlCommand\*\*：

&nbsp;   \*   属性：`CommandText` (SQL语句), `Connection`。

&nbsp;   \*   方法：

&nbsp;       \*   `ExecuteReader()`: 返回 `SqlDataReader` (用于SELECT)。

&nbsp;       \*   `ExecuteNonQuery()`: 返回受影响行数 (用于INSERT/UPDATE/DELETE)。

&nbsp;       \*   `ExecuteScalar()`: 返回第一行第一列 (用于聚合查询如COUNT)。

\*   \*\*SqlDataAdapter\*\*：

&nbsp;   \*   方法：`Fill()` (填充DataSet), `Update()` (提交更改回数据库)。



\### 3. 数据绑定

\*   \*\*简单绑定\*\*：绑定单个值到控件属性 (如 TextBox, Label)。

&nbsp;   \*   `textBox1.DataBindings.Add(...)`

\*   \*\*复杂绑定\*\*：绑定列表数据 (如 DataGridView, ComboBox)。

&nbsp;   \*   `dataGridView1.DataSource = myDataSet.Tables\[0];`

\*   \*\*BindingSource\*\*：作为数据源与控件之间的中间层，提供导航功能。



---



\## 考试重点提示 (Cheat Sheet)



1\.  \*\*E-R图绘制与转换\*\*：特别是多对多关系转换为关系模式时，需要把联系转成一张独立表。

2\.  \*\*SQL语句编写\*\*：

&nbsp;   \*   复杂查询：连接查询 (JOIN) 和 分组统计 (GROUP BY ... HAVING)。

&nbsp;   \*   数据更新：INSERT, UPDATE, DELETE 的基本语法。

3\.  \*\*理论概念\*\*：主键、外键的定义；实体完整性与参照完整性的区别；三级模式结构。

4\.  \*\*ADO.NET编程\*\*：

&nbsp;   \*   `DataReader` 与 `DataSet` 的区别 (在线 vs 离线)。

&nbsp;   \*   `ExecuteScalar` 与 `ExecuteNonQuery` 的用途区别。

&nbsp;   \*   编写简单的C#代码连接数据库并查询数据。

